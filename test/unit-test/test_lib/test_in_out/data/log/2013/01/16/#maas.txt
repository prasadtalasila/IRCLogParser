[00:10] <roaksoax> bigjools: howdy!
[00:11] <roaksoax> bigjools: https://code.launchpad.net/~andreserl/maas/update_maas_url_on_upgrade_raring
[00:11] <roaksoax> bigjools: so I proposed a branch for packaging that fixes the issues i found
[00:12] <roaksoax> the issue is that maas_cluster.conf has MAAS_URL=http://localhost/MAAS
[00:12] <roaksoax> this causes that the url passed on kernel parameters to be http://localhost/MAAS/metadata/etc/etc
[00:12] <roaksoax> (for example)
[00:13] <roaksoax> so the branch does two things
[00:13] <roaksoax> 1. Allows reconfiguration of MAAS_URL (becuase it only configures it in new installs and doesn't chagne it on dpkg-reconfigure)
[00:14] <roaksoax> 2. If no MAAS_URL has been set in dbconfig common, and the cluster-controller is installed in the same place where the maas-region-controller, then we obtain the MAAS_URL from DEFAULT_MAAS_URL (/etc/maas/maas_local_settings.py). Makes sense?
[00:28] <bigjools> I don't understand why this is a problem for you, we tested this before and didn't have any problems
[00:28] <bigjools> but either way I can't stop to look at this right now, sorry
[00:29] <bigjools> I'll go through it with rvb later
[00:47] <roaksoax> bigjools: this is a problem that i experienced in two different upgrades
[00:47] <roaksoax> bigjools: which broke MAS
[00:47] <roaksoax> MAAS
[00:48] <roaksoax> i installed a clean raring from archives and upgraded and the issue was preseny
[00:48] <roaksoax> i upgraded a quantal MAAS and problem was present
[00:50] <roaksoax> bigjools:  and did you guys test upgrades only or also test enlistment/commisioning
[00:50] <bigjools> I remember testing both
[00:51] <bigjools> can you chase this up with rvb
[00:51] <roaksoax> this was seen due to failing to enlist because the metadata url passed to cloud-init in kernel command line was http://localhost/MAAS/metadata
[00:51] <bigjools> I'll make sure he has time to look at it
[00:51] <roaksoax> ack
[00:51] <roaksoax> ill upload the package with my worksround either way
[00:51] <bigjools> I really don't understand how it's a problem - I know it worked for me :/
[00:53] <bigjools> don't upload anything yet
[00:53] <roaksoax> this fix is a packaging fix
[00:53] <roaksoax> which is minor
[00:53] <roaksoax> 1. is fixing dpkg-reconfigure (unrelated to thijs bug) 2. fixing this issue seen
[00:53] <roaksoax> and I need to move on
[00:53] <roaksoax> and get things done
[00:54] <roaksoax> and until I don't have anything in the archives then i'm blocked
[00:54] <roaksoax> either way, this can be removed, it is a 3 line change to fix this
[00:55] <roaksoax> i'll get you screenshots so you guys can figure out what went wrong inside MAAS
[02:36] <julianwa_> bigjools: hi
[02:37] <bigjools> roaksoax: ok thanks
[02:37] <bigjools> julianwa_: hi, so ...
[02:37] <bigjools> what do you need to customise exactly?
[02:38] <julianwa_> since 12.04 has ghes failed problem in kernel. I want to add  ghes.disable=1 there
[02:40] <bigjools> ok
[02:41] <bigjools> julianwa_: it's been a while since I touched the 12.04 code, but there's a pxe template that you can alter
[02:41] <bigjools> look under provisioningserver/pxe/
[02:42] <julianwa_> looks pxelinux.cfg/default is generated by cobbler.
[02:43] <bigjools> oh crap I forgot about cobbler
[02:44] <julianwa_> bigjools: that's ok. seems we found it in cobbler/config/profile.d/maas-enlist json file
[02:45] <bigjools> sorry - it's been a long time since I even thought about the cobbler code, it's just a bad memory
[02:45] <bigjools> let me know how you get on
[02:46] <julianwa_> yes. I'm trying
[03:16] <julianwa_> bigjools: it is done by change 'kernel options' in cobbler cmdline
[03:16] <bigjools> ah ok
[03:16] <bigjools> julianwa_: bear in mind that we're doing an SRU soon that completely removes the Cobbler part
[03:41] <julianwa_> bigjools:  sure, I'd like to try the new MaaS and Juju :)
=== dannf` is now known as dannf
=== ehw_ is now known as ehw
[16:13] <spideyman> bigjools: Hi
[16:13] <spideyman> can anyone have a look at: https://bugs.launchpad.net/maas/+bug/1100091
[16:13] <ubot5> Launchpad bug 1100091 in MAAS "Kernel opts tagging feature missing completely" [Undecided,New]
[16:40] <roaksoax> rvba: howdy
[16:40] <roaksoax> rvba: so I just tested an upgrade with your fix on it
[16:40] <roaksoax> rvba: and the same issue ramins
[16:40] <roaksoax> remains
[16:41] <rvba> roaksoax: did you upgrade from a 'broken' server?  My fix can't fix a broken server, but it's prevent it from getting broken.
[16:42] <roaksoax> nope not broken server
[16:42] <roaksoax> upgrade from an archive one
[16:42] <roaksoax> let me test again
[16:43] <rvba> roaksoax: can you run something like: http://paste.ubuntu.com/1538064/
[16:43] <roaksoax> ok, just destroyed my environment
[16:43] <roaksoax> re testing
[17:14] <roaksoax> rvba: weird. It works this time
[17:14] <roaksoax> rvba: so I confirm it is fixed
[17:15] <roaksoax> rvba: thanks for your work on it :)
[17:23] <rvba> roaksoax: cool, I'm relieved.  Thanks for testing it.
=== matsubara is now known as matsubara-afk
[19:21] <roadmr> hey folks, kernel_opts is not working suddenly, what happened to it? :( got renamed?
[19:59] <bitwiz> good afternoon, I just installed 12.10 maas and I am up to the point where I need to add an ssh key to the maas superuser account 'root'. I generate a key set using "ssh-keygen -t dsa -f root" afterwhich i cut and paste the key in the dashboard and it informs me that it is invalid. so what am i missing?
[20:05] <roadmr> bitwiz: are you pasting the contents of root.pub in the dashboard?
[20:05] <bitwiz> yes, and that is when i get the error
[20:06] <roadmr> bitwiz: ok, try removing the -t dsa parameter
[20:06] <bitwiz> i do a more root.pub on a putty term, and copy and paste the output
[20:06] <roadmr> bitwiz: can you do this right now? I'd like to know if that works
[20:06] <bitwiz> yes i can
[20:06] <roadmr> awesome, thanks
[20:07] <roadmr> bitwiz: if you omit "-t dsa" it will generate a rsa key by default
[20:07] <roadmr> bitwiz: btw I don't promise it will work, it's just a stab in the dark :)
[20:08] <bitwiz> same error without "-t dsa"
[20:10] <roadmr> bitwiz: ok, let's have a look at the key itself then
[20:10] <bitwiz> ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCrKwLGTe1DCfF1u+lq/YeOl4y0YLPMIv7KYR6yhzFFJLfC0uiZHaGe596W4/gKxygPJ7xyK9kxmn90fPqFh6ms4NT/rZk20Foifuu3N06C/zhWyh4OUDomMnF/W MJfvq+lYr/Gq2DEYaij8/irMleB3TVanRimjv1rP3AjfzlE0VSBSWMlAYyD+dsB3QdqKUo1VqE90kcwfWCyIn/H1oR5b1HDNuCNWhJ/iPra7AinLJ2KH6wXOQ+rot7vfBq+HZdqy/TtjsKVlQW7kkQ1HixdJzMQ2l ddTps9q8ev8eDIv2Lv7XfFaj+oS6nl7az8ux1xTd4ihvrXs2rE7kZr3R33 root@cloud-controller
[20:10] <roadmr> bitwiz: can you paste your .pub key here? (just as if you were going to paste it in the maas console)
[20:10] <roadmr> http://paste.ubuntu.com/
[20:12] <bitwiz> ok it is pasted
[20:12] <roadmr> bitwiz: when you pasted it, it gave you a url http://paste.ubuntu.com/<some number>
[20:12] <roadmr> can you put that url here?
[20:13] <bitwiz> http://paste.ubuntu.com/1538666/
[20:13] <roadmr> fantastic, thanks
[20:13] <roadmr> ok as you can see, your key is split into three lines
[20:13] <bitwiz> is that the issue
[20:13] <roadmr> bitwiz: yes, what you need to do is this
[20:14] <roadmr> paste it in the maas panel but before clicking "add key", delete the stray spaces at the end of each line
[20:14] <roadmr> bitwiz: there's one after F/W
[20:14] <bitwiz> ok, let me try that
[20:15] <roadmr> and another after Q2l
[20:15] <roadmr> bitwiz: the spaces are what's throwing it off, mostly
[20:16] <bitwiz> you are correct.. it took the key this time. thank you
[20:16] <roadmr> bitwiz: awesome, glad it worked :)
[20:17] <bitwiz> i would have never thought of that. Now i know to look for multilines in keys
[20:18] <roadmr> bitwiz: it's probably an issue with copying it from the terminal, maybe putty somehow inserts those spaces
[20:18] <roadmr> bitwiz: I *think* multilines are fine, but once you squash them, the spaces cause the key string to be invalid
[20:19] <bitwiz> that makes sense
[21:38] <dsb> dannf: why...hello there.  ;)
[21:38] <dannf> hey dsb
=== adam_g_ is now known as adam_g
